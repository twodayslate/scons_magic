import os
env = SpecialEnvironment()

Import('self')
print("Parsing '%s' with options:\n\t%s" % (self, self.options))

# Includes('common', env)
lib = env.ImportLibrary(self, 'common')

if 'linux' in self.options["platform"]:
    env.Append(LINKFLAGS='-rdynamic')

p = env.Program('program', Glob('*.c'), LIBS=[lib])

exported = env.Install(os.path.join('#/export', self.path()), p)
Default(exported)
Return('exported')