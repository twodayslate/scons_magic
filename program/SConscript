import os
env = Environment()

Import('self')
print("Parsing '%s' with options:\n\t%s" % (self, self.options))

Includes('common', env)

if 'linux' in self.options["platform"]:
    env.Append(LINKFLAGS='-rdynamic')
    env.AppendUnique(CPPDEFINES={'FLAGVALUE': 1})
else:
    env.AppendUnique(CPPDEFINES={'FLAGVALUE': 666})

p = env.Program('program', Glob('*.c'), libs=['common'])

i = env.Install(os.path.join(GetLaunchDir(), 'export'), p)
Default(i)
Return('p')