import os
import sys
import platform

Import('*')

print("Parsing", self.name, ":", self.platform, self.arch, self.bits)

if 'x86_64' in self.arch:
    env.Append(LINKFLAGS='-rdynamic')

libCommon = env.SConscript('../common/SConscript', exports={'self': self, 'env': env})

p = env.Program('program', SpecialGlob(self, '*.c'), LIBS=[libCommon], CPPPATH="$COMMON_INCLUDES")

exported = env.Install("$EXPORT_DIR", p)
Default(exported)
env.Alias(os.path.join('build', self.path(), self.name), exported)
env.Alias(os.path.join('build', self.path()), exported)
if self.parsedTarget:
	env.Alias(self.parsedTarget, exported)
Return('exported')